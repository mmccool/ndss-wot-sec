Choosing what security metadata to include in a TD is not a straightforward task.
Many things must be taken into account: 
various deployment scenarios and configurations, 
underlying networking protocols and their security mechanisms, 
overall scalability, system security priorities, and so on.

A data packet in a WoT network can go over many intermediate entities,
including gateways and proxies.
Some of these entities might need to perform authentication 
and authorization of the requester. 
The security metadata in the TD should indicate
what types of credentials are required by each entity and how to obtain them.

For example, consider the deployment scenario in Figure~\ref{fig-wot-scenario}.
Suppose the forwarding proxy requires authentication of any request before passing it to the local network.
Additionally assume that the WoT gateway performs authentication 
at least for certain critical interactions provided by the WoT Thing 
(for example, unlocking a door). 
Both of these authentication methods (potentially different) and 
associated information must be specified in the TD 
that the WoT Client receives from the Thing Directory.
The WoT gateway can perform the authentication of the WoT Client 
in a number of ways depending on what standards the target devices support.
For example, the OCF Security Specification~\cite{ocf2017} 
describes a number of ways IoT devices can perform authentication based on 
either symmetrical or asymmetrical credentials (including certificates). 
However, provisioning credentials in advance 
is not ideal for a distributed network such as the WoT is intended to support.
Another possibility is to use a token-based authentication mechanism,
such as OAuth 2.0 or Proof-of-Possession tokens~\cite{ace2017}.
Token-based authentication allows  
a WoT Client to dynamically request a token from a remotely 
located authorization server and present it for 
authentication to a WoT gateway or Thing.
This method has its own risks, as tokens need to be protected
from interception.

Generalizing the above example, 
there might be $N$ sets of fully independent security metadata
necessary in a Thing Description.
Moreover, when a Thing Description is composed, 
these sets can be provided by separate entities: 
a gateway might only specify the security metadata for accessing interactions defined in a TD,
while the forwarding proxy adds the metadata required for successful authentication of incoming requests.
This means that there has to be a way to limit what security metadata 
is allowed to be provided by what entity.
Also, it must be possible for the WoT client to verify the overall integrity of the resulting TD. 
 
